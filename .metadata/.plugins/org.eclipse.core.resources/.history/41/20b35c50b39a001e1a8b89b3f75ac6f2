package com.curd.service;

//ApiService.java
import org.springframework.http.*;
import org.springframework.stereotype.Service;
import org.springframework.web.client.RestTemplate;

@Service
public class ApiService {

 private final String BASE_URL = "https://qa2.sunbasedata.com/sunbase/portal/api/";

 public String authenticateUser(String loginId, String password) {
	 try {
		 
		  String url = BASE_URL + "assignment_auth.jsp";
		     RestTemplate restTemplate = new RestTemplate();

		     HttpHeaders headers = new HttpHeaders();
		     headers.setContentType(MediaType.APPLICATION_JSON);

		     String body = String.format("{\"login_id\":\"%s\",\"password\":\"%s\"}", loginId, password);
		     System.out.println(body+" id"+loginId);
		     HttpEntity<String> requestEntity = new HttpEntity<>(body, headers);

		     ResponseEntity<String> responseEntity = restTemplate.postForEntity(url, requestEntity, String.class);
		     System.out.println(responseEntity);
		     if (responseEntity.getStatusCode() == HttpStatus.OK) {
		    	 System.out.print("x"+responseEntity.getBody());
		         return responseEntity.getBody();
		     } else {
		         // Handle authentication failure
		         return null;
		     }
		
	} catch (Exception e) {
		System.out.println(e);
	}
     String url = BASE_URL + "assignment_auth.jsp";
     RestTemplate restTemplate = new RestTemplate();

     HttpHeaders headers = new HttpHeaders();
     headers.setContentType(MediaType.APPLICATION_JSON);

     String body = String.format("{\"login_id\":\"%s\",\"password\":\"%s\"}", loginId, password);

     HttpEntity<String> requestEntity = new HttpEntity<>(body, headers);

     ResponseEntity<String> responseEntity = restTemplate.postForEntity(url, requestEntity, String.class);

     if (responseEntity.getStatusCode() == HttpStatus.OK) {
    	 System.err.println(responseEntity.getBody());
         return responseEntity.getBody();
     } else {
         // Handle authentication failure
         return null;
     }
 }

 // Implement methods for createCustomer, getCustomerList, deleteCustomer, and updateCustomer
}
